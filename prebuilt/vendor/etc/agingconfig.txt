unique_session_name: "saot_perfmond"

write_into_file: true
flush_period_ms: 30000
file_write_period_ms: 604800000
incremental_state_config {
  clear_period_ms: 15000
}
buffers {
    size_kb: 30720
    fill_policy: RING_BUFFER
}
buffers {
    size_kb: 2048
    fill_policy: RING_BUFFER
}

data_sources {
    config {
        name: "android.surfaceflinger.frametimeline"
        target_buffer: 0
    }
}

data_sources {
    config {
        name: "linux.ftrace"
        target_buffer: 0
        ftrace_config {
            throttle_rss_stat: true
            symbolize_ksyms: true
            disable_generic_events: true
            ksyms_mem_policy: KSYMS_RETAIN
            compact_sched {
                enabled: true
            }
            # os.Trace markers:
            ftrace_events: "ftrace/print"
            # LMK
            atrace_apps: "lmkd"
            ftrace_events: "lowmemorykiller/lowmemory_kill"
            ftrace_events: "oom/oom_score_adj_update"
            ftrace_events: "oom/mark_victim"
            # RSS and ION buffer events:
            ftrace_events: "gpu_mem/gpu_mem_total"
            ftrace_events: "dmabuf_heap/dma_heap_stat"
            ftrace_events: "ion/ion_stat"
            ftrace_events: "kmem/ion_heap_grow"
            ftrace_events: "kmem/ion_heap_shrink"
            ftrace_events: "rss_stat"
            ftrace_events: "fastrpc/fastrpc_dma_stat"
            # Scheduling information & process tracking. Useful for:
            # - what is happening on each CPU at each moment
            # - why a thread was descheduled
            # - parent/child relationships between processes and threads.
            ftrace_events: "power/suspend_resume"
            ftrace_events: "sched/sched_blocked_reason"
            ftrace_events: "sched/sched_process_free"
            ftrace_events: "sched/sched_switch"
            ftrace_events: "task/task_newtask"
            ftrace_events: "task/task_rename"
            # Wakeup info. Allows you to compute how long a task was
            # blocked due to CPU contention.
            ftrace_events: "sched/sched_waking"
            ftrace_events: "sched/sched_wakeup_new"
            # vmscan and mm_compaction events.
            ftrace_events: "compaction/mm_compaction_begin"
            ftrace_events: "compaction/mm_compaction_end"
            # Atrace activity manager:
            atrace_categories: "am"
            # Atrace camera category:
            atrace_categories: "camera"
            # Atrace system_server:
            atrace_categories: "ss"
            # Java and C:
            atrace_categories: "memory"
            atrace_categories: "memreclaim"
            atrace_categories: "idle"
            atrace_categories: "dalvik"
            atrace_categories: "bionic"
            atrace_categories: "aidl"
            atrace_categories: "binder_driver"
            atrace_categories: "database"
            atrace_categories: "disk"
            atrace_categories: "freq"
            atrace_categories: "gfx"
            atrace_categories: "hal"
            atrace_categories: "res"
            atrace_categories: "sched"
            atrace_categories: "view"
            atrace_categories: "wm"
            atrace_categories: "thermal"
            atrace_categories: "power"
            atrace_categories: "audio"
            atrace_apps: "*"
            buffer_size_kb: 16384
        }
    }
}

data_sources {
    config {
        name: "linux.process_stats"
        target_buffer: 1
        process_stats_config {
            proc_stats_poll_ms: 60000
        }
    }
}
data_sources: {
    config {
        name: "android.sys_stats"
        target_buffer: 1
        sys_stats_config {
            vmstat_period_ms: 1000
        }
    }
}

data_sources {
  config {
    name: "linux.sys_stats"
    target_buffer: 1
    sys_stats_config {
      meminfo_period_ms: 1000
      meminfo_counters: MEMINFO_ACTIVE_ANON
      meminfo_counters: MEMINFO_ACTIVE_FILE
      meminfo_counters: MEMINFO_INACTIVE_ANON
      meminfo_counters: MEMINFO_INACTIVE_FILE
      meminfo_counters: MEMINFO_KERNEL_STACK
      meminfo_counters: MEMINFO_MLOCKED
      meminfo_counters: MEMINFO_SHMEM
      meminfo_counters: MEMINFO_SLAB
      meminfo_counters: MEMINFO_SLAB_UNRECLAIMABLE
      meminfo_counters: MEMINFO_VMALLOC_USED
      meminfo_counters: MEMINFO_MEM_FREE
      meminfo_counters: MEMINFO_SWAP_FREE
    }
  }
}
